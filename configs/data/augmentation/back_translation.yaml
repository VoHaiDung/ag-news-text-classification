# Back Translation Augmentation Configuration
# ===========================================
#
# Back translation for data augmentation following:
# - Sennrich et al. (2016): "Improving Neural Machine Translation Models with Monolingual Data"
# - Edunov et al. (2018): "Understanding Back-Translation at Scale"
# - Xie et al. (2020): "Unsupervised Data Augmentation for Consistency Training"
#
# Author: Võ Hải Dũng

name: back_translation_augmentation
type: augmentation
description: "Generate augmented data via back-translation"

# Translation settings
translation:
  # Service to use
  service: "transformers"  # transformers, google, marian
  
  # Model configuration
  model_name: "Helsinki-NLP/opus-mt-en-de"
  back_model_name: "Helsinki-NLP/opus-mt-de-en"
  
  # Pivot languages for back-translation
  pivot_languages:
    - language: "de"
      forward_model: "Helsinki-NLP/opus-mt-en-de"
      backward_model: "Helsinki-NLP/opus-mt-de-en"
      weight: 0.3
      
    - language: "fr"
      forward_model: "Helsinki-NLP/opus-mt-en-fr"
      backward_model: "Helsinki-NLP/opus-mt-fr-en"
      weight: 0.3
      
    - language: "es"
      forward_model: "Helsinki-NLP/opus-mt-en-es"
      backward_model: "Helsinki-NLP/opus-mt-es-en"
      weight: 0.2
      
    - language: "zh"
      forward_model: "Helsinki-NLP/opus-mt-en-zh"
      backward_model: "Helsinki-NLP/opus-mt-zh-en"
      weight: 0.2

# Generation parameters
generation:
  # Beam search
  num_beams: 5
  
  # Sampling
  do_sample: true
  temperature: 0.9
  top_k: 50
  top_p: 0.95
  
  # Length
  max_length: 512
  min_length: 10
  
  # Diversity
  num_return_sequences: 3
  diversity_penalty: 0.5

# Quality control
quality_control:
  # Semantic similarity threshold
  min_similarity: 0.8
  similarity_model: "sentence-transformers/all-MiniLM-L6-v2"
  
  # Length constraints
  min_length_ratio: 0.7
  max_length_ratio: 1.3
  
  # Language detection
  check_language: true
  target_language: "en"
  
  # Grammar check
  check_grammar: false
  max_grammar_errors: 3

# Filtering
filtering:
  # Remove if translation fails
  remove_failed: true
  
  # Remove identical translations
  remove_identical: true
  
  # Remove low quality
  quality_threshold: 0.7

# Sampling strategy
sampling:
  # Which samples to augment
  augment_all: false
  max_samples_per_class: 1000
  
  # Priority for augmentation
  prioritize_minority_classes: true
  
  # Augmentation ratio
  augmentation_ratio: 1.0  # 1:1 original to augmented

# Performance
performance:
  batch_size: 32
  num_workers: 4
  
  # Caching
  cache_translations: true
  cache_dir: "./cache/translations"

# Expected results
expected_results:
  data_increase: "2x"
  diversity_increase: "+30%"
  accuracy_improvement: "+1-2%"
  robustness_improvement: "+3-5%"

# References
references:
  - paper: "Sennrich et al. (2016)"
    url: "https://arxiv.org/abs/1511.06709"
  - paper: "Edunov et al. (2018)"
    url: "https://arxiv.org/abs/1808.09381"
