# ============================================================================
# Test Environment Configuration for AG News Text Classification
# ============================================================================
# Project: AG News Text Classification (ag-news-text-classification)
# Description: Environment variables for automated testing
# Author: Võ Hải Dũng
# Email: vohaidung.work@gmail.com
# License: MIT
# ============================================================================
#
# Academic Rationale:
#   Following the Twelve-Factor App methodology (https://12factor.net/) and
#   best practices from "Continuous Delivery" (Humble & Farley, 2010), this
#   configuration separates environment-specific settings from code. Test
#   environments require isolated, reproducible, and fast execution settings
#   that differ significantly from production configurations.
#
# Design Principles:
#   1. Isolation: Test database, cache, and services isolated from production
#   2. Speed: Smaller models, reduced epochs, limited data for fast tests
#   3. Determinism: Fixed seeds, disabled randomness for reproducibility
#   4. Safety: Mock external services, use test credentials only
#   5. Observability: Enhanced logging and debugging for test failures
#
# Security Note:
#   ALL VALUES IN THIS FILE ARE FOR TESTING ONLY.
#   Never use these credentials, keys, or settings in production.
#   This file can be safely committed to version control as it contains
#   no sensitive information.
#
# Usage:
#   Automatic:  Loaded by pytest via python-dotenv
#   Manual:     export $(cat .env.test | xargs)
#   Validation: python -c "from dotenv import dotenv_values; print(dotenv_values('.env.test'))"
#
# References:
#   - Twelve-Factor App: https://12factor.net/config
#   - pytest-env: https://github.com/pytest-dev/pytest-env
#   - python-dotenv: https://github.com/theskumar/python-dotenv
#
# ============================================================================

# ============================================================================
# Project Identification
# ============================================================================
# Metadata for test environment identification and version tracking.

PROJECT_NAME="AG News Text Classification"
PROJECT_SLUG="ag-news-text-classification"
PROJECT_VERSION="1.0.0"
ENVIRONMENT="test"
DEBUG=true
VERBOSE=true
LOG_LEVEL="DEBUG"

# ============================================================================
# Path Configuration
# ============================================================================
# Directory structure following project layout. Using relative paths for
# portability across different test runners (local, CI/CD, Docker).

ROOT_DIR="."
SRC_DIR="./src"
DATA_DIR="./data/test"
CONFIG_DIR="./configs"
MODEL_DIR="./outputs/models/test"
OUTPUT_DIR="./outputs/test"
LOG_DIR="./outputs/logs/test"
CACHE_DIR="./.cache/test"
TEMP_DIR="./tmp/test"
CHECKPOINT_DIR="./outputs/models/test/checkpoints"

# ============================================================================
# Testing Framework Configuration
# ============================================================================
# Pytest and testing tool settings for comprehensive test execution.

TEST_MODE=true
TEST_TIMEOUT=300
TEST_SAMPLE_SIZE=100
TEST_RANDOM_SEED=42
TEST_DETERMINISTIC=true

PYTEST_WORKERS=4
PYTEST_VERBOSE=true
PYTEST_CAPTURE="no"
PYTEST_STRICT_MARKERS=true
PYTEST_JUNIT_XML="test-results/junit.xml"

COVERAGE_THRESHOLD=80
COVERAGE_REPORT_HTML=true
COVERAGE_REPORT_XML=true
COVERAGE_FAIL_UNDER=70

HYPOTHESIS_PROFILE="test"
HYPOTHESIS_MAX_EXAMPLES=50
HYPOTHESIS_DERANDOMIZE=true

# ============================================================================
# Model Configuration - Small Models for Speed
# ============================================================================
# Using smaller models and reduced parameters for fast test execution.
# Following the principle that tests should be fast enough to run frequently.

DEFAULT_MODEL="distilbert-base-uncased"
BACKUP_MODEL="bert-base-uncased"

TRANSFORMER_MODEL_TYPE="distilbert"
TRANSFORMER_MODEL_NAME="distilbert-base-uncased"
TRANSFORMER_NUM_LABELS=4

LLM_MODEL_TYPE="gpt2"
LLM_MODEL_NAME="gpt2"

MAX_SEQUENCE_LENGTH=128
MAX_TOKEN_LENGTH=128
PADDING_STRATEGY="max_length"
TRUNCATION_STRATEGY="longest_first"

# ============================================================================
# Training Configuration - Minimal for Testing
# ============================================================================
# Reduced training parameters for fast test execution while maintaining
# enough complexity to catch training-related bugs.

BATCH_SIZE=8
EVAL_BATCH_SIZE=16
GRADIENT_ACCUMULATION_STEPS=1

NUM_TRAIN_EPOCHS=2
MAX_STEPS=-1
WARMUP_STEPS=10
WARMUP_RATIO=0.1

LEARNING_RATE=2e-5
WEIGHT_DECAY=0.01
ADAM_EPSILON=1e-8
MAX_GRAD_NORM=1.0

EVAL_STRATEGY="epoch"
SAVE_STRATEGY="epoch"
SAVE_TOTAL_LIMIT=2
SAVE_STEPS=100

LOGGING_STEPS=10
EVAL_STEPS=50

# ============================================================================
# Data Configuration - Limited Data for Speed
# ============================================================================
# Using small data samples for fast tests while maintaining statistical
# validity for catching data processing bugs.

USE_SAMPLE_DATA=true
SAMPLE_DATA_SIZE=1000
TRAIN_SAMPLE_SIZE=800
VAL_SAMPLE_SIZE=100
TEST_SAMPLE_SIZE=100

DATA_VALIDATION_ENABLED=true
DATA_AUGMENTATION_ENABLED=false
DATA_STRATIFIED_SPLIT=true

TRAIN_RATIO=0.8
VAL_RATIO=0.1
TEST_RATIO=0.1

NUM_WORKERS=2
PREFETCH_FACTOR=2
PIN_MEMORY=false

# ============================================================================
# Overfitting Prevention Configuration
# ============================================================================
# Testing overfitting prevention system with relaxed constraints for
# test execution speed while validating prevention mechanisms.

OVERFITTING_PREVENTION_ENABLED=true
OVERFITTING_MONITOR_ENABLED=true
OVERFITTING_THRESHOLD=0.1
OVERFITTING_PATIENCE=3

EARLY_STOPPING_ENABLED=true
EARLY_STOPPING_PATIENCE=5
EARLY_STOPPING_THRESHOLD=0.01

VALIDATION_GUARD_ENABLED=true
TEST_SET_GUARD_ENABLED=true
TEST_SET_PROTECTION=true

COMPLEXITY_MONITOR_ENABLED=true
PARAMETER_EFFICIENCY_CHECK=true

LORA_RANK_LIMIT=16
QLORA_BITS_LIMIT=4
MAX_TRAINABLE_PARAMETERS=10000000

# ============================================================================
# Platform Configuration
# ============================================================================
# Platform detection and optimization for testing across different
# environments (local, Colab, Kaggle, CI/CD).

PLATFORM="local"
PLATFORM_AUTO_DETECT=true
PLATFORM_OPTIMIZATION_ENABLED=false

COLAB_DETECTION=false
KAGGLE_DETECTION=false
LOCAL_DETECTION=true

QUOTA_TRACKING_ENABLED=false
QUOTA_LIMIT_ENABLED=false
SESSION_MANAGEMENT_ENABLED=false

# ============================================================================
# Hardware Configuration - CPU Only for CI/CD
# ============================================================================
# CPU-only configuration for CI/CD environments. GPU tests run separately
# in GPU-enabled environments.

CUDA_VISIBLE_DEVICES=""
USE_GPU=false
USE_CPU=true
USE_TPU=false

DEVICE="cpu"
NUM_GPUS=0
GPU_MEMORY_LIMIT=0

MIXED_PRECISION=false
FP16=false
BF16=false

GRADIENT_CHECKPOINTING=false
GRADIENT_CHECKPOINTING_KWARGS={}

# ============================================================================
# Efficient Fine-Tuning Configuration
# ============================================================================
# LoRA and QLoRA settings for testing parameter-efficient methods.

LORA_ENABLED=false
LORA_R=8
LORA_ALPHA=16
LORA_DROPOUT=0.1
LORA_TARGET_MODULES="q_proj,v_proj"
LORA_BIAS="none"

QLORA_ENABLED=false
QLORA_BITS=4
QLORA_USE_4BIT=false
QLORA_USE_8BIT=false

ADAPTER_ENABLED=false
PREFIX_TUNING_ENABLED=false
PROMPT_TUNING_ENABLED=false

# ============================================================================
# Ensemble Configuration
# ============================================================================
# Minimal ensemble settings for testing ensemble functionality.

ENSEMBLE_ENABLED=false
ENSEMBLE_SIZE=2
ENSEMBLE_METHOD="soft_voting"
ENSEMBLE_WEIGHTS="uniform"

# ============================================================================
# Knowledge Distillation Configuration
# ============================================================================
# Distillation settings for testing teacher-student frameworks.

DISTILLATION_ENABLED=false
DISTILLATION_TEMPERATURE=2.0
DISTILLATION_ALPHA=0.5
TEACHER_MODEL="bert-base-uncased"
STUDENT_MODEL="distilbert-base-uncased"

# ============================================================================
# Database Configuration - Test Database
# ============================================================================
# SQLite for lightweight test database. Isolated from production data.

DATABASE_BACKEND="sqlite"
DATABASE_URL="sqlite:///./test.db"
DATABASE_POOL_SIZE=5
DATABASE_MAX_OVERFLOW=10
DATABASE_ECHO=false
DATABASE_AUTO_MIGRATE=true

# ============================================================================
# Cache Configuration - Test Cache
# ============================================================================
# Redis test instance or mock cache for testing caching functionality.

CACHE_BACKEND="redis"
REDIS_URL="redis://localhost:6379/1"
REDIS_PREFIX="ag_news_test"
REDIS_TTL=60
REDIS_ENABLED=false

CACHE_ENABLED=false
CACHE_TYPE="simple"
CACHE_DEFAULT_TIMEOUT=60

# ============================================================================
# API Configuration - Test API Server
# ============================================================================
# Test API server running on different port to avoid conflicts.

API_ENABLED=true
API_HOST="127.0.0.1"
API_PORT=8001
API_WORKERS=1
API_RELOAD=false
API_DEBUG=true

API_DOCS_ENABLED=true
API_REDOC_ENABLED=true
API_OPENAPI_URL="/openapi.json"

API_RATE_LIMIT=1000
API_RATE_LIMIT_ENABLED=false
API_TIMEOUT=30

API_CORS_ENABLED=true
API_CORS_ORIGINS="http://localhost:3000,http://127.0.0.1:3000"

# ============================================================================
# Security Configuration - Test Credentials
# ============================================================================
# Test-only credentials. Never use in production.

SECRET_KEY="test_secret_key_for_testing_only_not_for_production"
JWT_SECRET="test_jwt_secret_for_testing_only"
JWT_ALGORITHM="HS256"
JWT_EXPIRATION_MINUTES=60
JWT_REFRESH_EXPIRATION_DAYS=7

ALLOWED_HOSTS="localhost,127.0.0.1,testserver"
CORS_ORIGINS="http://localhost:3000,http://127.0.0.1:3000"

HASH_ALGORITHM="bcrypt"
SALT_ROUNDS=4

# ============================================================================
# External Services - Mocked for Testing
# ============================================================================
# All external services are mocked or disabled for isolated testing.

USE_MOCK_SERVICES=true
MOCK_EXTERNAL_APIS=true

OPENAI_API_KEY="test_openai_key_not_real"
OPENAI_MODEL="gpt-3.5-turbo"
OPENAI_ENABLED=false
MOCK_GPT_RESPONSES=true

ANTHROPIC_API_KEY="test_anthropic_key_not_real"
ANTHROPIC_ENABLED=false

COHERE_API_KEY="test_cohere_key_not_real"
COHERE_ENABLED=false

# ============================================================================
# Experiment Tracking - Offline Mode
# ============================================================================
# Experiment tracking tools in offline mode for testing.

WANDB_MODE="offline"
WANDB_PROJECT="ag-news-test"
WANDB_ENTITY="test-entity"
WANDB_API_KEY="test_wandb_key_not_real"
WANDB_DISABLED=true
WANDB_SILENT=true

MLFLOW_TRACKING_URI="file:./outputs/test/mlruns"
MLFLOW_EXPERIMENT_NAME="test-experiment"
MLFLOW_ENABLED=false

TENSORBOARD_ENABLED=false
TENSORBOARD_LOG_DIR="./outputs/logs/test/tensorboard"

NEPTUNE_API_TOKEN="test_neptune_token_not_real"
NEPTUNE_PROJECT="test/ag-news"
NEPTUNE_ENABLED=false

# ============================================================================
# Hugging Face Configuration - Offline Mode
# ============================================================================
# Hugging Face in offline mode using cached models.

HF_TOKEN="test_hf_token_not_real"
HF_DATASETS_OFFLINE=true
TRANSFORMERS_OFFLINE=true
HF_HOME="./.cache/huggingface/test"
TRANSFORMERS_CACHE="./.cache/transformers/test"
HF_DATASETS_CACHE="./.cache/datasets/test"

HF_HUB_ENABLE_HF_TRANSFER=false

# ============================================================================
# Monitoring Configuration - Disabled
# ============================================================================
# Monitoring tools disabled for faster test execution.

PROMETHEUS_ENABLED=false
PROMETHEUS_PORT=9091

GRAFANA_ENABLED=false
GRAFANA_PORT=3001

METRICS_ENABLED=false
TRACING_ENABLED=false
PROFILING_ENABLED=false

SENTRY_DSN=""
SENTRY_ENABLED=false

# ============================================================================
# Logging Configuration - Verbose for Debugging
# ============================================================================
# Enhanced logging for test debugging and failure analysis.

LOG_FORMAT="%(asctime)s - %(name)s - %(levelname)s - %(message)s"
LOG_DATE_FORMAT="%Y-%m-%d %H:%M:%S"
LOG_FILE="./outputs/logs/test/test.log"
LOG_ROTATION="1 MB"
LOG_RETENTION="7 days"

LOGGING_CONSOLE_ENABLED=true
LOGGING_FILE_ENABLED=true
LOGGING_JSON_ENABLED=false

# ============================================================================
# Feature Flags - Test All Features
# ============================================================================
# Enable experimental features for comprehensive testing.

ENABLE_EXPERIMENTAL_FEATURES=true
ENABLE_PROMPT_ENGINEERING=true
ENABLE_INSTRUCTION_TUNING=true
ENABLE_DISTILLATION=false
ENABLE_ENSEMBLE=false
ENABLE_ACTIVE_LEARNING=false
ENABLE_CURRICULUM_LEARNING=false
ENABLE_ADVERSARIAL_TRAINING=false
ENABLE_MULTI_STAGE_TRAINING=false

# ============================================================================
# CI/CD Integration
# ============================================================================
# CI/CD specific environment variables.

CI=true
CI_COMMIT_SHA="test_commit_sha"
CI_COMMIT_BRANCH="test_branch"
CI_PIPELINE_ID="test_pipeline_id"

GITHUB_ACTIONS=true
GITHUB_WORKSPACE="."
GITHUB_SHA="test_sha"
GITHUB_REF="refs/heads/test"

CODECOV_TOKEN="test_codecov_token_not_real"
CODECOV_ENABLED=false

# ============================================================================
# Test Data Generation
# ============================================================================
# Settings for synthetic test data generation using Faker.

FAKER_SEED=42
FAKER_LOCALE="en_US"
GENERATE_TEST_DATA=true
TEST_DATA_OUTPUT_DIR="./data/test/generated"

# ============================================================================
# Test Cleanup Configuration
# ============================================================================
# Automatic cleanup of test artifacts.

AUTO_CLEANUP=true
CLEANUP_ON_SUCCESS=true
CLEANUP_ON_FAILURE=false
PRESERVE_FAILED_TEST_DATA=true
CLEANUP_TEMP_FILES=true
CLEANUP_CACHE=false

# ============================================================================
# Assertion and Validation Configuration
# ============================================================================
# Test assertion behavior and validation settings.

PYTEST_ASSERT_DETAILS=true
PYTEST_STRICT_MARKERS=true
PYTEST_STRICT_CONFIG=true
PYTEST_VERBOSITY_TEST_CASES=2

VALIDATE_SCHEMAS=true
VALIDATE_TYPES=true
VALIDATE_CONSTRAINTS=true

# ============================================================================
# Mock Configuration
# ============================================================================
# Configuration for mocking external dependencies.

MOCK_EXTERNAL_APIS=true
MOCK_DATABASE_CALLS=false
MOCK_FILE_SYSTEM=false
MOCK_NETWORK_CALLS=true
USE_FIXTURES=true
FIXTURES_DIR="./tests/fixtures"

# ============================================================================
# Test Categorization
# ============================================================================
# Enable/disable different test categories.

RUN_UNIT_TESTS=true
RUN_INTEGRATION_TESTS=false
RUN_E2E_TESTS=false
RUN_PERFORMANCE_TESTS=false
RUN_REGRESSION_TESTS=false

INTEGRATION_TEST_TIMEOUT=600
E2E_TEST_TIMEOUT=1200
PERFORMANCE_TEST_TIMEOUT=3600

# ============================================================================
# Documentation and Reporting
# ============================================================================
# Test documentation and report generation.

GENERATE_TEST_DOCS=false
GENERATE_COVERAGE_REPORT=true
GENERATE_PERFORMANCE_REPORT=false
GENERATE_HTML_REPORT=true
GENERATE_XML_REPORT=true

TEST_REPORT_DIR="./test-results"
COVERAGE_REPORT_DIR="./test-results/coverage"

# ============================================================================
# Debugging Configuration
# ============================================================================
# Enhanced debugging for test development and failure investigation.

ENABLE_BREAKPOINTS=false
SAVE_TEST_ARTIFACTS=true
VERBOSE_TEST_OUTPUT=true
CAPTURE_LOGS=true
CAPTURE_STDOUT=true
CAPTURE_STDERR=true

DEBUG_MODE=true
DEBUG_LEVEL=2
TRACEBACK_LIMIT=10

# ============================================================================
# Performance and Resource Limits
# ============================================================================
# Resource limits for test execution.

MAX_WORKERS=2
THREAD_POOL_SIZE=4
CONNECTION_POOL_SIZE=5
MAX_MEMORY_MB=2048
MAX_CPU_PERCENT=80

# ============================================================================
# Reproducibility Settings
# ============================================================================
# Settings ensuring reproducible test results.

RANDOM_SEED=42
NUMPY_SEED=42
TORCH_SEED=42
PYTHON_SEED=42

DETERMINISTIC_MODE=true
CUDNN_DETERMINISTIC=true
CUDNN_BENCHMARK=false

# ============================================================================
# Parallel Testing Configuration
# ============================================================================
# Settings for parallel test execution.

PARALLEL_TESTING=true
PARALLEL_WORKERS=4
PARALLEL_BACKEND="threading"

# ============================================================================
# Test Data Paths
# ============================================================================
# Specific paths for test data files.

TEST_DATA_AG_NEWS="./data/test_samples/ag_news_sample.csv"
TEST_DATA_MOCK="./data/test_samples/mock_data.json"
TEST_CONFIG_DIR="./configs/tests"

# ============================================================================
# Notification Configuration
# ============================================================================
# Test result notification settings (disabled for CI/CD).

NOTIFICATION_ENABLED=false
SLACK_WEBHOOK_URL=""
EMAIL_ENABLED=false

# ============================================================================
# Notes
# ============================================================================
#
# Usage Instructions:
#   1. Copy to .env.test.local for local overrides (gitignored)
#   2. Override specific values for different test scenarios
#   3. Use pytest-env plugin for automatic loading
#   4. Validate with: python -m dotenv list
#
# Security Reminders:
#   - All credentials are test-only, never use in production
#   - This file is safe to commit to version control
#   - Real secrets should be in .env.local (gitignored)
#   - Rotate any accidentally committed real credentials
#
# Test Strategy:
#   - Fast: Small models, limited data, CPU only
#   - Isolated: Separate database, cache, ports
#   - Reproducible: Fixed seeds, deterministic mode
#   - Safe: Mocked services, test credentials
#
# Maintenance:
#   - Review quarterly as project evolves
#   - Update model names when adding new architectures
#   - Sync with production .env.example
#   - Document rationale for non-obvious settings
#
# ============================================================================
